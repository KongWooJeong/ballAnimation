

# 💻 Ball Animation

<br>

# 💡 실행 방법
```
 npm install

 npm start

 localhost:3000
```

<br>

# 🔍 문제 정의 및 해결 과정
<br>

### 1. 공이 벽에 부딪힌 경우 반사각으로 튕겨져 나간다.
- 공이 벽에 부딪힌 경우 감지
  - 위, 아래쪽 벽 충돌 감지
    - 아래쪽 벽: 공의 위치(**y 좌표**)가 (canvas 전체 높이 - 공의 반지름) 보다 클 경우.
    - 위쪽 벽: 공의 위치(**y 좌표**)가 (0 + 공의 반지름) 보다 작은 경우.
  - 왼, 오른쪽 벽 충돌 감지
    - 왼쪽 벽: 공의 위치(**x 좌표**)가 (0 + 공의 반지름) 보다 작은 경우.
    - 오른쪽 벽: 공의 위치(**x 좌표**)가 (canvas 전체 넓이 - 공의 반지름) 보다 클 경우.
- 벽에 부딪힌 후 반사각으로 튕겨져 나간다.
  - 위, 아래쪽 벽: 이동하게 될 **y좌표** 부호를 반대로 변경한다. => dy = -dy
  - 왼, 오른쪽 벽: 이동하게 될 **x좌표** 부호를 반대로 변경한다. => dx = -dx  

<br />

### 2. 공과 공이 부딪힐경우 반사각으로 튕겨져 나갑니다.
- 공과 공이 부딪힌 경우 감지
  - 공A 위치(**x, y 좌표**)와 공B 위치(**x, y 좌표**)의 거리가 (공A 반지름 + 공B 반지름) 보다 작거나 같은 경우
  - 공A와 공B의 거리는 삼각형으로 그려 피타고라스 정리를 이용하여 빗변의 길이를 구합니다.
- 공과 공이 부딪힌 후 반사각으로 튕겨져 나간다.
  - 반사각으로 튕겨져 나갈때 속도는 각 공의 속도가 유지되므로 충돌 방향만 알 수 있으면 된다. 
  - 충돌 방향 구하기
    - 충돌 방향을 구하기 위해선 충돌 벡터의 단위 벡터를 구하면 된다.  
      (단위 벡터: 크기가 1인 충돌 벡터, 즉 방향에 대한 정보를 얻을 수 있는 벡터이다.)
    - 충돌 벡터 정보
      - ```collisionVector = {x: 공B.x - 공A.x, y: 공B.y - 공A.y  }```
    - 단위 벡터 구하기
      - 충돌 벡터에 거리(크기)를 나누면 됩니다.
      - 충돌 벡터 크기(```collisionDistance```): 두개의 공에서 삼각형을 그려 피타고라스 정리를 이용하여 빗변의 길이를 구한다.
      - 단위 벡터: ```unitVector = {x: collisionVector.x / collisionDistance, y: collisionVector.y / collisionDistance }```  

  - 반사각을 튕겨져 나간다. (공A는 충동 방향의 반대로 움직이고, 공B는 충돌 방향대로 움직인다.)
    - 공A.dx = 공A.속도 * -unitVector.x
    - 공A.dy = 공A.속도 * -unitVector.y
    - 공B.dx = 공B.속도 * unitVector.x
    - 공B.dy = 공B.속도 * unitVector.y

<br />

### 3. 랜덤하게 정해진 공의 속도는 어느 환경에서도 일정해야합니다, px/s 이용
- requestAnimationFrame
  - 프레임을 통해 화면을 그린다. 프레임은 초당 특정 횟수 만큼 업데이트 된니다.
  - 초당 그려지는 프레임 수(fps, 프레임 속도)는 모든 하드웨어가 동일하게 생성되지 않기 때문에 게임이 실행되는 하드웨어에 따라 다릅니다.
- delta time
  - 현재 프레임과 마지막 프레임의 시간 차이
- 프레임 속도는 하드웨어마다 동일하지 않으므로 프레임 속도에 의존하지 않고 delta time을 이용하여 공을 이동한다.
```
// 마지막 프레임이 이후 경과된 시간(초)
// (currentTimeStamp - oldTimeStamp)는 밀리 초 이므로 1000으로 나누어 초로 변환한다.
const deltaSecond = (currentTimeStamp - oldTimeStamp) / 1000;

// px/s 1초에 이동하게 px
공A.x += 공A.dx * deltaSecond;
공A.y += 공A.dy * deltaSecond;
```

<br />

### 4. 0 ~ 360 사이의 랜덤한 각도로 공이 날아갑니다.
- 0, 360 각도를 렌던하게 생성
- 각도를 이용하여 x, y좌표 구하기 (아동하게 될 방향)
  - x: Math.cos(각도)
  - y: Math.sin(각도)
- 방향은 구해졌으니 공의 속도를 이용하여 거리 구하기
  - dx: Math.cos(각도) * 공.속도
  - dy: Math.sin(각도) * 공.속도
 